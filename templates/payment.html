{% extends "layout/base.html" %} {% block style %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/payment.css') }}" />
{% endblock %}

{% block content %}
<div class="container mt-4">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{{ url_for('home') }}" class="text-decoration-none text-dark">Home</a>
            </li>
            <li class="breadcrumb-item"><a href="{{ url_for('cart') }}" class="text-decoration-none text-dark">Cart</a>
            </li>
            <li class="breadcrumb-item active">Payment</li>
        </ol>
    </nav>

    <h2 class="mb-4">Details</h2>

    <div class="row">
        <div class="col-md-7 mb-4">
            <div class="card border-primary">
                <div class="card-body">
                    <form method="POST">
                        {{ form.hidden_tag() }}

                        <div class="mb-3">
                            {{ form.first_name.label(class="form-label") }}
                            <span class="text-danger">*</span>
                            {{ form.first_name(class="form-control") }}
                            {% if form.first_name.errors %}
                            <div class="text-danger">{{ form.first_name.errors[0] }}</div>
                            {% endif %}
                        </div>

                        <div class="mb-3">
                            {{ form.company_name.label(class="form-label") }}
                            {{ form.company_name(class="form-control") }}
                        </div>

                        <div class="mb-3">
                            {{ form.street_address.label(class="form-label") }}
                            {{ form.street_address(class="form-control") }}
                        </div>

                        <div class="mb-3">
                            {{ form.apartment.label(class="form-label") }}
                            {{ form.apartment(class="form-control") }}
                        </div>

                        <div class="mb-3">
                            {{ form.city.label(class="form-label") }}
                            <span class="text-danger">*</span>
                            {{ form.city(class="form-control") }}
                            {% if form.city.errors %}
                            <div class="text-danger">{{ form.city.errors[0] }}</div>
                            {% endif %}
                        </div>

                        <div class="mb-3">
                            {{ form.phone.label(class="form-label") }}
                            <span class="text-danger">*</span>
                            {{ form.phone(class="form-control",
                            pattern="[0-9]{10}",
                            title="10 digit mobile number (no special characters)",
                            oninput="this.value=this.value.replace(/[^0-9]/g,'');") }}
                            {% if form.phone.errors %}
                            <div class="text-danger">{{ form.phone.errors[0] }}</div>
                            {% endif %}
                        </div>

                        <div class="mb-3">
                            {{ form.email.label(class="form-label") }}
                            <span class="text-danger">*</span>
                            {{ form.email(class="form-control",
                            type="email",
                            pattern="[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$",
                            title="Please enter a valid email (e.g., example@domain.com)") }}
                            {% if form.email.errors %}
                            <div class="text-danger">{{ form.email.errors[0] }}</div>
                            {% endif %}
                        </div>

                        <div class="form-check mb-4">
                            {{ form.save_info(class="form-check-input") }}
                            {{ form.save_info.label(class="form-check-label") }}
                        </div>
                </div>
            </div>
        </div>

        <div class="col-md-5">
            <div class="card border-primary h-auto">
                <div class="card-body">
                    <h5 class="card-title">Cart Total</h5>

                    <div class="d-flex justify-content-between mb-2">
                        <span>Subtotal:</span>
                        <span>₹{{ "%.2f"|format(subtotal) }}</span>
                    </div>

                    <hr class="border-primary">

                    <div class="d-flex justify-content-between mb-2">
                        <span>Discount:</span>
                        <span>-₹{{ "%.2f"|format(discount) }}</span>
                    </div>

                    <hr class="border-primary">

                    <div class="d-flex justify-content-between mb-2">
                        <span>Shipping:</span>
                        <span>Free</span>
                    </div>

                    <hr class="border-primary">

                    <div class="d-flex justify-content-between  fs-5 mb-4">
                        <span>Total:</span>
                        <span>₹{{ "%.2f"|format(total) }}</span>
                    </div>

                    <div class="mb-4">
                        <img src="{{ url_for('static', filename='images/payment.png') }}" class="img-fluid"
                            alt="Payment Options">
                    </div>

                    <div class="text-center"> 
                        <div class="form-group mb-3 d-inline-block text-left">
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="payment_method" id="cash"
                                    value="cash" checked>
                                <label class="form-check-label" for="cash">
                                    Cash on delivery
                                </label>
                            </div>
                        </div>

                        <div class="text-center"> 
                            <button type="submit" class="btn btn-primary py-2" style="width: 200px;">
                                Place Order
                            </button>
                        </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endblock %}
    {% block scripts %}
    <script src="{{ url_for('static', filename='js/payment.js') }}"></script>
    {% endblock %}